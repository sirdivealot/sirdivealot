const   path = require('path')
const     fs = require('fs')
const sizeOf = require('image-size')

function figure(pic) {
	const source = pic.path
	const  thumb = pic.path
	const  width = pic.width
	const height = pic.height
	const   text = "a good pict"
	return `
<figure itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
	<a href="${source}" itemprop="contentUrl" data-size="${width}x${height}">
		<img class="g-img lazy" src="" data-src="${thumb}" itemprop="thumbnail" alt="${text}"/>
	</a>
</figure>
`
}

module.exports = function(images) {

	// images = [ relative-path-to-img ]
	// e.g.     [ img/mabul17/day1/IMG_XYZ.jpeg ]

	const pics = images.map(image => {
		const dim = sizeOf(image.absolute)
		return {
			  path: image.relative,
			 width: dim.width,
			height: dim.height
		}
	})

	const content = `
<div class="gallery" itemscope itemtype="http://schema.org/ImageGallery">
	${pics.map(figure).join('\n')}
</div>
`

	return content
}