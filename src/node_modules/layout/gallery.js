const fs   = require('fs')
const path = require('path')

delete require.cache[__filename]

var scripts = [
	"/js/gallery.js",
	"/js/photoswipe.min.js",
	"/js/photoswipe-ui-default.min.js"
]

var pwsp_styles = [
 	'/css/photoswipe.css',
	'/css/default-skin/default-skin.css'
]

module.exports = function (output, page, header, content) {
	const prologue = `
		<div class="container">
			<div class="content">
				<h1>${header}</h1>
				<span>Last updated ${fs.statSync(module.parent.filename).mtime.toUTCString()}</span>
		`
	const epilogue = `
		</div>
	</div>
	`

	output.write(require('partials/header')(pwsp_styles))
	output.write('<body>')
	output.write(require('partials/jumbo')())
	output.write(require('partials/nav')(page))
	output.write(prologue)
	output.write(content)
	output.write(epilogue)
	output.write(require('partials/pswp')())

	scripts.forEach(script => output.write(
		`<script src="${path.join(process.env.dir, script)}"></script>`
	))
	output.write('</body>')
	output.write(require('partials/footer')())
}